<!doctype html>
<html lang="en-us">
  <head>
    <title>Unlocking My Keyboard // Automate attention</title>
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.78.1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://blog.brujordet.no/css/main.min.4c68b05cd7072e94a56c3a8acdd6f6e73fb7a62ba6e1bb047413ce09c4fea7a8.css" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Unlocking My Keyboard"/>
<meta name="twitter:description" content="tl;dr Remapping caps lock to control and escape on Linux
The elephant on the keyboard Nothing good has ever come from pressing the CAPS LOCK key, either accidentally or intentionally during a heated discussion on IRC. As a long time user of Macbooks I&rsquo;ve used Karabiner to improve the way my keyboard works. My most critical customization is to let the CAPS LOCK key die. Instead it will send escape if pressed alone, and control if pressed with any other key."/>

    <meta property="og:title" content="Unlocking My Keyboard" />
<meta property="og:description" content="tl;dr Remapping caps lock to control and escape on Linux
The elephant on the keyboard Nothing good has ever come from pressing the CAPS LOCK key, either accidentally or intentionally during a heated discussion on IRC. As a long time user of Macbooks I&rsquo;ve used Karabiner to improve the way my keyboard works. My most critical customization is to let the CAPS LOCK key die. Instead it will send escape if pressed alone, and control if pressed with any other key." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.brujordet.no/post/productivity/unlocking-my-keyboard/" />
<meta property="article:published_time" content="2020-11-24T21:27:29+01:00" />
<meta property="article:modified_time" content="2020-11-24T21:27:29+01:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://blog.brujordet.no/"><img class="app-header-avatar" src="/avatar.png" alt="John Doe" /></a>
      <h1>Automate attention</h1>
      <p>Tools and techniques I use to make life easier</p>
      <a href="https://blog.brujordet.no//about">About me</a>
      <div class="app-header-social">
        
          <a target="_blank" href="https://twitter.com/brujoand" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg></a>
        
          <a target="_blank" href="https://www.linkedin.com/in/brujoand" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>linkedin</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg></a>
        
          <a target="_blank" href="https://www.github.com/brujoand" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Unlocking My Keyboard</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Nov 24, 2020
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div><div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>
</svg>
          <a class="tag" href="https://blog.brujordet.no/tags/linux/">linux</a><a class="tag" href="https://blog.brujordet.no/tags/vim/">vim</a><a class="tag" href="https://blog.brujordet.no/tags/keyboard/">keyboard</a></div></div>
    </header>
    <div class="post-content">
      <p>tl;dr Remapping caps lock to control and escape on Linux</p>
<h1 id="the-elephant-on-the-keyboard">The elephant on the keyboard</h1>
<p>Nothing good has ever come from pressing the CAPS LOCK key, either accidentally
or intentionally during a heated discussion on IRC. As a long time user of
Macbooks I&rsquo;ve used <a href="https://karabiner-elements.pqrs.org/">Karabiner</a> to improve
the way my keyboard works. My most critical customization is to
let the CAPS LOCK key die. Instead it will send escape if pressed alone, and
control if pressed with any other key. Super nice for vim, the shell and just
about anything. Recently I&rsquo;ve decided to come back to the Linux desktop and I
searched far and wide for a replacement for karabiner. Finally I&rsquo;ve found the
Interception tools.</p>
<h1 id="how-to-get-this-magic-sauce">How to get this magic sauce?</h1>
<p>So if you head over to <a href="https://gitlab.com/interception/linux/tools">Interception
tools</a> and install it, and while
you&rsquo;re there you should also grab the <a href="https://gitlab.com/interception/linux/plugins/dual-function-keys">Dual Function
Keys</a> plugin.</p>
<p>First we create a systemd service in <code>/etc/systemd/system/udevmon.service</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>Unit<span style="color:#f92672">]</span>
Description<span style="color:#f92672">=</span>udevmon
Wants<span style="color:#f92672">=</span>systemd-udev-settle.service
After<span style="color:#f92672">=</span>systemd-udev-settle.service

<span style="color:#f92672">[</span>Service<span style="color:#f92672">]</span>
ExecStart<span style="color:#f92672">=</span>/usr/local/bin/udevmon -c /etc/udevmon.yaml
Nice<span style="color:#f92672">=</span>-20

<span style="color:#f92672">[</span>Install<span style="color:#f92672">]</span>
WantedBy<span style="color:#f92672">=</span>multi-user.target
</code></pre></div><p>Note that the udevmon location might vary depending on how you installed it.</p>
<p>Then we should define the referenced <code>/etc/udevmon.yaml</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">- JOB: <span style="color:#e6db74">&#34;intercept -g `DEVNODE | dual-function-keys -c /etc/builtin-keyboard-modifications.yaml | uinput -d `DEVNODE&#34;</span>
  DEVICE:
    NAME: <span style="color:#e6db74">&#34;Apple Inc. Apple Internal Keyboard / Trackpad&#34;</span>
    EVENTS:
      EV_KEY: <span style="color:#f92672">[</span>KEY_CAPSLOCK<span style="color:#f92672">]</span>
</code></pre></div><p>We&rsquo;re basically saying whenever my apple keyboard is sending events, we hijack
the KEY_CAPSLOCK and do whatever is defined in
<code>/etc/builtin-keyboard-modifications.yaml</code>. So you might want to run something
similar to the following to find the name of your keyboard:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo uinput -p -d /dev/input/by-id/X
</code></pre></div><p>Where &lsquo;X&rsquo; is whatever seems to be your keyboard.
There can be a bunch of different ones laying around so make sure that it has at
least the KEY_CAPSLOCK which we want to remap.</p>
<p>When that&rsquo;s all done we can finally create the actual mapping in
<code>/etc/builtin-keyboard-modifications.yaml</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">TIMING:
  TAP_MILLISEC: <span style="color:#ae81ff">200</span>
  DOUBLE_TAP_MILLISEC: <span style="color:#ae81ff">150</span>

MAPPINGS:
  - KEY: KEY_CAPSLOCK
    TAP: KEY_ESC
    HOLD: KEY_LEFTCTRL
</code></pre></div><p>Then all we need is a quick <code>systemctl enable udevmon.service</code> and a tiny
<code>systemctl enable udevmon.service</code> and bobs your uncle! :D</p>
<p>These tools are crazy powerful and more examples can be found over
<a href="https://gitlab.com/interception/linux/plugins/dual-function-keys/-/blob/master/doc/examples.md">here</a></p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
